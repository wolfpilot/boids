parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"wD9p":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t={isEnabled:!0,fill:"#fff"};class i{constructor(i,s){this.canvas=i,this.ctx=s,this.state=Object.assign({},t)}init(){this.resize()}draw(){this.ctx.fillStyle=this.state.fill,this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height)}resize(){const t=window.devicePixelRatio,i=window.innerWidth,s=window.innerHeight;this.canvas.width=i*t,this.canvas.height=s*t,this.canvas.style.width=`${i}px`,this.canvas.style.height=`${s}px`,this.ctx.scale(t,t),this.draw()}}exports.default=i;
},{}],"CMpB":[function(require,module,exports) {
"use strict";var e=this&&this.__decorate||function(e,t,r,o){var n,s=arguments.length,a=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var c=e.length-1;c>=0;c--)(n=e[c])&&(a=(s<3?n(a):s>3?n(t,r,a):n(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(exports,"__esModule",{value:!0}),exports.AppStore=void 0;const t=require("@datorama/akita"),r={isRunning:!0,elapsedTime:0,lastDrawTime:0};let o=class extends t.Store{constructor(){super(r)}};o=e([(0,t.StoreConfig)({name:"app"})],o),exports.AppStore=o;
},{}],"Ps4c":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AppService=void 0;class e{constructor(e){this.appStore=e}updateIsRunning(e){this.appStore.update({isRunning:e})}updateElapsedTime(e){this.appStore.update({elapsedTime:e})}updateLastDrawTime(e){this.appStore.update({lastDrawTime:e})}}exports.AppService=e;
},{}],"v9iO":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AppQuery=void 0;const e=require("@datorama/akita");class t extends e.Query{constructor(e){super(e),this.store=e,this.allState$=this.select(),this.elapsedTime$=this.select("elapsedTime"),this.lastDrawTime$=this.select("lastDrawTime")}get allValues(){return this.getValue()}get isRunning(){return this.getValue().isRunning}get elapsedTime(){return this.getValue().elapsedTime}get lastDrawTime(){return this.getValue().lastDrawTime}}exports.AppQuery=t;
},{}],"Whxz":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.appQuery=exports.appService=exports.appStore=exports.AppQuery=exports.AppService=exports.AppStore=void 0;const e=require("./app.store");Object.defineProperty(exports,"AppStore",{enumerable:!0,get:function(){return e.AppStore}});const p=require("./app.service");Object.defineProperty(exports,"AppService",{enumerable:!0,get:function(){return p.AppService}});const r=require("./app.query");Object.defineProperty(exports,"AppQuery",{enumerable:!0,get:function(){return r.AppQuery}}),exports.appStore=new e.AppStore,exports.appService=new p.AppService(exports.appStore),exports.appQuery=new r.AppQuery(exports.appStore);
},{"./app.store":"CMpB","./app.service":"Ps4c","./app.query":"v9iO"}],"NL7x":[function(require,module,exports) {
"use strict";var e=this&&this.__decorate||function(e,t,r,o){var s,a=arguments.length,c=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,r,o);else for(var i=e.length-1;i>=0;i--)(s=e[i])&&(c=(a<3?s(c):a>3?s(t,r,c):s(t,r))||c);return a>3&&c&&Object.defineProperty(t,r,c),c};Object.defineProperty(exports,"__esModule",{value:!0}),exports.GuiStore=void 0;const t=require("@datorama/akita"),r={maxFps:60,showFps:!0,showTargetVector:!0,showNormalizedTargetVector:!0,showVelocityVector:!0,showAwarenessArea:!1,showSeparationArea:!0,showStoppingArea:!1};let o=class extends t.Store{constructor(){super(r)}};o=e([(0,t.StoreConfig)({name:"gui"})],o),exports.GuiStore=o;
},{}],"GCJw":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GuiService=void 0;class e{constructor(e){this.guiStore=e}updateMaxFps(e){this.guiStore.update({maxFps:e})}updateShowFps(e){this.guiStore.update({showFps:e})}updateShowTargetVector(e){this.guiStore.update({showTargetVector:e})}updateShowNormalizedTargetVector(e){this.guiStore.update({showNormalizedTargetVector:e})}updateShowVelocityVector(e){this.guiStore.update({showVelocityVector:e})}updateShowAwarenessArea(e){this.guiStore.update({showAwarenessArea:e})}updateShowSeparationArea(e){this.guiStore.update({showSeparationArea:e})}updateShowStoppingArea(e){this.guiStore.update({showStoppingArea:e})}}exports.GuiService=e;
},{}],"CDZj":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GuiQuery=void 0;const e=require("@datorama/akita");class t extends e.Query{constructor(e){super(e),this.store=e,this.allState$=this.select(),this.showFps$=this.select("showFps")}get allValues(){return this.getValue()}get maxFps(){return this.getValue().maxFps}get showFps(){return this.getValue().showFps}get showTargetVector(){return this.getValue().showTargetVector}get showNormalizedTargetVector(){return this.getValue().showNormalizedTargetVector}get showVelocityVector(){return this.getValue().showVelocityVector}get showAwarenessArea(){return this.getValue().showAwarenessArea}get showSeparationArea(){return this.getValue().showSeparationArea}get showStoppingArea(){return this.getValue().showStoppingArea}}exports.GuiQuery=t;
},{}],"yh4b":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.guiQuery=exports.guiService=exports.guiStore=exports.GuiQuery=exports.GuiService=exports.GuiStore=void 0;const e=require("./gui.store");Object.defineProperty(exports,"GuiStore",{enumerable:!0,get:function(){return e.GuiStore}});const r=require("./gui.service");Object.defineProperty(exports,"GuiService",{enumerable:!0,get:function(){return r.GuiService}});const t=require("./gui.query");Object.defineProperty(exports,"GuiQuery",{enumerable:!0,get:function(){return t.GuiQuery}}),exports.guiStore=new e.GuiStore,exports.guiService=new r.GuiService(exports.guiStore),exports.guiQuery=new t.GuiQuery(exports.guiStore);
},{"./gui.store":"NL7x","./gui.service":"GCJw","./gui.query":"CDZj"}],"EhYJ":[function(require,module,exports) {
"use strict";var e=this&&this.__decorate||function(e,t,o,r){var s,c=arguments.length,i=c<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,r);else for(var n=e.length-1;n>=0;n--)(s=e[n])&&(i=(c<3?s(i):c>3?s(t,o,i):s(t,o))||i);return c>3&&i&&Object.defineProperty(t,o,i),i};Object.defineProperty(exports,"__esModule",{value:!0}),exports.BoidsStore=void 0;const t=require("@datorama/akita"),o={boids:[]};let r=class extends t.EntityStore{constructor(){super(o)}};r=e([(0,t.StoreConfig)({name:"boids"})],r),exports.BoidsStore=r;
},{}],"Ykd7":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BoidsQuery=void 0;const t=require("@datorama/akita");class e extends t.QueryEntity{constructor(t){super(t),this.store=t,this.allState$=this.select()}get all(){return this.getAll()}getBoid(t){return this.getEntity(t)}getOtherBoids(t){return this.getAll().filter(e=>e.id!==t)}}exports.BoidsQuery=e;
},{}],"iX1u":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.boidsQuery=exports.boidsStore=exports.BoidsQuery=exports.BoidsStore=void 0;const e=require("./boids.store");Object.defineProperty(exports,"BoidsStore",{enumerable:!0,get:function(){return e.BoidsStore}});const o=require("./boids.query");Object.defineProperty(exports,"BoidsQuery",{enumerable:!0,get:function(){return o.BoidsQuery}}),exports.boidsStore=new e.BoidsStore,exports.boidsQuery=new o.BoidsQuery(exports.boidsStore);
},{"./boids.store":"EhYJ","./boids.query":"Ykd7"}],"tFZS":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("../stores/app");class i{constructor(){this.handleVisibilityToggle=(()=>{const i="visible"===document.visibilityState;e.appService.updateIsRunning(i)})}init(){document.addEventListener("visibilitychange",this.handleVisibilityToggle,!1)}}exports.default=new i;
},{"../stores/app":"Whxz"}],"f5Ey":[function(require,module,exports) {
"use strict";var e=this&&this.__decorate||function(e,t,r,o){var i,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(c=(n<3?i(c):n>3?i(t,r,c):i(t,r))||c);return n>3&&c&&Object.defineProperty(t,r,c),c};Object.defineProperty(exports,"__esModule",{value:!0}),exports.UiStore=void 0;const t=require("@datorama/akita"),r={pointerVector:{x:window.innerWidth/2,y:window.innerHeight/2}};let o=class extends t.Store{constructor(){super(r)}};o=e([(0,t.StoreConfig)({name:"ui"})],o),exports.UiStore=o;
},{}],"iZ2l":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.UiService=void 0;class e{constructor(e){this.uiStore=e}updatePointerVector(e){this.uiStore.update({pointerVector:e})}}exports.UiService=e;
},{}],"xOLB":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.UiQuery=void 0;const e=require("@datorama/akita");class t extends e.Query{constructor(e){super(e),this.store=e,this.allState$=this.select(),this.pointerVector$=this.select("pointerVector")}get allValues(){return this.getValue()}get pointerVector(){return this.getValue().pointerVector}}exports.UiQuery=t;
},{}],"Bdnu":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.uiQuery=exports.uiService=exports.uiStore=exports.UiQuery=exports.UiService=exports.UiStore=void 0;const e=require("./ui.store");Object.defineProperty(exports,"UiStore",{enumerable:!0,get:function(){return e.UiStore}});const r=require("./ui.service");Object.defineProperty(exports,"UiService",{enumerable:!0,get:function(){return r.UiService}});const t=require("./ui.query");Object.defineProperty(exports,"UiQuery",{enumerable:!0,get:function(){return t.UiQuery}}),exports.uiStore=new e.UiStore,exports.uiService=new r.UiService(exports.uiStore),exports.uiQuery=new t.UiQuery(exports.uiStore);
},{"./ui.store":"f5Ey","./ui.service":"iZ2l","./ui.query":"xOLB"}],"KiIX":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("../stores/ui");class t{constructor(){this.handlePointerMove=(e=>{requestAnimationFrame(()=>this.updatePointer(e))}),this.updatePointer=(t=>{e.uiService.updatePointerVector({x:t.x,y:t.y})})}init(){document.addEventListener("pointermove",this.handlePointerMove)}}exports.default=new t;
},{"../stores/ui":"Bdnu"}],"jjzx":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BOID_COLORS=void 0,exports.BOID_COLORS=["#f89a99","#FD4365","#ee6048","#f89859","#f8eac0","#f8ca65","#f8ba2d","#f3ca85","#c5eb9d","#a4d5a3","#bceae9","#95d3d5","#c2a4e7"];
},{}],"rrcm":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.config=void 0;const e=require("./constants/colors");exports.config={boids:{total:20,minSize:30,maxSize:60,maxSpeedMultiplier:.1,brakingMultiplier:.15,awarenessMultiplier:8,separationMultiplier:1.25,frictionMultiplier:333e-8,colors:e.BOID_COLORS}};
},{"./constants/colors":"jjzx"}],"wDIF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getRandomNumber=exports.mapFromToRange=exports.sum=void 0;const e=e=>e.reduce((e,o)=>e+o);exports.sum=e;const o=(e,o,r,t,s)=>{return t+(s-t)/(r-o)*(e-o)};exports.mapFromToRange=o;const r=(e,o=0)=>Math.floor(Math.random()*(o-e+1))+e;exports.getRandomNumber=r;
},{}],"LS1Y":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.config=void 0,exports.config={maxSteeringForce:.5,alignmentFactor:.025,stopDistanceThreshold:2.5,stopVelocityTreshold:.1,targetVector:{color:"#c4c4c4"},directionVector:{color:"#ff0000"},velocityVector:{color:"#151515"},brakingArea:{color:"#ff0000"}};
},{}],"Mg1U":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class e{constructor(e,t){this.x=e,this.y=t}}exports.default=e;
},{}],"ILUX":[function(require,module,exports) {
"use strict";var t=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.applyForces=exports.setMagnitude=exports.limitMagnitude=exports.normalize=exports.magSq=exports.mag=exports.divide=exports.multiply=exports.subtract=exports.add=void 0;const e=require("./mathHelper"),r=t(require("../geometry/Vector")),s=(t,e)=>new r.default(t.x+e.x,t.y+e.y);exports.add=s;const o=(t,e)=>new r.default(t.x-e.x,t.y-e.y);exports.subtract=o;const n=(t,e)=>{const{x:s,y:o}=t,n=s*e,p=o*e;return new r.default(n,p)};exports.multiply=n;const p=(t,e)=>{const{x:s,y:o}=t,n=s/e,p=o/e;return new r.default(n,p)};exports.divide=p;const x=t=>Math.sqrt(t.x*t.x+t.y*t.y);exports.mag=x;const u=t=>t.x*t.x+t.y*t.y;exports.magSq=u;const a=t=>{const e=(0,exports.mag)(t);return 0===e?new r.default(1,0):(0,exports.divide)(t,e)};exports.normalize=a;const i=(t,e)=>{if((0,exports.mag)(t)>e){const r=(0,exports.normalize)(t);return(0,exports.multiply)(r,e)}return t};exports.limitMagnitude=i;const l=(t,e)=>{const r=(0,exports.normalize)(t);return(0,exports.multiply)(r,e)};exports.setMagnitude=l;const d=(t,s)=>{const o=s.map(t=>t.x),n=s.map(t=>t.y);return new r.default(t.x+(0,e.sum)(o),t.y+(0,e.sum)(n))};exports.applyForces=d;
},{"./mathHelper":"wDIF","../geometry/Vector":"Mg1U"}],"Mizr":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isEntityOffscreen=exports.isEntityOutside=void 0;const i=({v:i,radius:t,minX:e,minY:s,maxX:n,maxY:r})=>i.y<s-t||i.x>n+t||i.y>r+t||i.x<e-t;exports.isEntityOutside=i;const t=({v:i,radius:t})=>(0,exports.isEntityOutside)({v:i,radius:t,minX:0,minY:0,maxX:window.innerWidth,maxY:window.innerHeight});exports.isEntityOffscreen=t;
},{}],"GVUQ":[function(require,module,exports) {
"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.seek=void 0;const t=require("../actors/Boid/config"),r=require("../utils/vectorHelper"),i=require("../utils/mathHelper"),s=e(require("../geometry/Vector")),o=({target:e,source:o})=>{let a=new s.default(0,0);const u=(0,r.subtract)(e,o.state.location),c=(0,r.mag)(u);if(c>0&&c<o.traits.brakingDistance){const e=(0,i.mapFromToRange)(c,0,100,0,o.traits.maxSpeed);a=(0,r.multiply)(u,e)}else a=(0,r.setMagnitude)(u,o.traits.maxSpeed);const n=(0,r.subtract)(a,o.state.velocity);return(0,r.limitMagnitude)(n,t.config.maxSteeringForce)};exports.seek=o;
},{"../actors/Boid/config":"LS1Y","../utils/vectorHelper":"ILUX","../utils/mathHelper":"wDIF","../geometry/Vector":"Mg1U"}],"tpWc":[function(require,module,exports) {
"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.align=void 0;const t=require("../actors/Boid/config"),r=require("../utils/vectorHelper"),i=e(require("../geometry/Vector")),o=(e,t)=>{const i=(0,r.subtract)(e.state.location,t.state.location),o=(0,r.mag)(i);return o>0&&o<t.traits.awarenessAreaSize},a=({boids:e,source:a})=>{let s=new i.default(0,0);const n=e.filter(e=>o(e,a));if(0===n.length)return s;const l=n.map(e=>e.state.velocity).reduce((e,t)=>(0,r.add)(e,t)),c=(0,r.normalize)(l),u=(0,r.divide)(c,n.length);return s=(0,r.subtract)(u,a.state.velocity),s=(0,r.multiply)(s,t.config.alignmentFactor)};exports.align=a;
},{"../actors/Boid/config":"LS1Y","../utils/vectorHelper":"ILUX","../geometry/Vector":"Mg1U"}],"EB6p":[function(require,module,exports) {
"use strict";var t=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.separate=void 0;const e=require("../utils/vectorHelper"),r=t(require("../geometry/Vector")),a=(t,r)=>{const a=(0,e.subtract)(t.state.location,r.state.location),o=(0,e.mag)(a);return o>0&&o<r.traits.separationAreaSize+t.traits.size},o=({boids:t,source:o})=>{let s=new r.default(0,0);const i=t.filter(t=>a(t,o));return 0===i.length?s:(i.forEach(t=>{let r=(0,e.subtract)(o.state.location,t.state.location);r=(0,e.normalize)(r),r=(0,e.multiply)(r,o.traits.maxSpeed),s=(0,e.add)(s,r)}),s)};exports.separate=o;
},{"../utils/vectorHelper":"ILUX","../geometry/Vector":"Mg1U"}],"Kfov":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.separate=exports.align=exports.seek=void 0;const e=require("./seekBehaviour");Object.defineProperty(exports,"seek",{enumerable:!0,get:function(){return e.seek}});const r=require("./alignBehaviour");Object.defineProperty(exports,"align",{enumerable:!0,get:function(){return r.align}});const t=require("./separateBehaviour");Object.defineProperty(exports,"separate",{enumerable:!0,get:function(){return t.separate}});
},{"./seekBehaviour":"GVUQ","./alignBehaviour":"tpWc","./separateBehaviour":"EB6p"}],"NGTN":[function(require,module,exports) {
"use strict";var t=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.BehaviourKind=void 0;const e=require("./config"),i=require("../../stores/app"),s=require("../../stores/gui"),a=require("../../stores/ui"),o=require("../../stores/boids"),r=require("../../utils/vectorHelper"),c=require("../../utils/entityHelper"),l=require("../../behaviours/index"),n=t(require("../../geometry/Vector"));var h;!function(t){t.Seek="seek",t.Align="align",t.Separate="separate"}(h=exports.BehaviourKind||(exports.BehaviourKind={}));const u={location:new n.default(0,0),acceleration:new n.default(0,0),velocity:new n.default(0,0),friction:new n.default(0,0),targetVector:new n.default(0,0),normTargetVector:new n.default(0,0)};class d{constructor({id:t,ctx:i,x:s,y:c,size:l,maxSpeedMultiplier:d,frictionMultiplier:x,brakingMultiplier:g,awarenessMultiplier:p,separationMultiplier:y,color:b}){this.update=(()=>{const t=o.boidsQuery.getBoid(this.id);if(!t)return;const i=(0,r.subtract)(a.uiQuery.pointerVector,t.state.location),s=(0,r.mag)(i),c=(0,r.normalize)(t.state.targetVector),l=(0,r.mag)(t.state.velocity),n=Object.assign(Object.assign({},t),{state:Object.assign(Object.assign({},t.state),{targetVector:i,normTargetVector:c})});s<e.config.stopDistanceThreshold&&l<e.config.stopVelocityTreshold?this.handleStopUpdate(n):this.handleContinueUpdate(n)}),this.id=t,this.ctx=i,this.behaviours=[h.Seek,h.Align,h.Separate],this.traits={size:l,maxSpeed:l*d,frictionFactor:l*l*l*x,brakingDistance:l*l*g,awarenessAreaSize:l*p,separationAreaSize:l*y,color:b},this.state=Object.assign(Object.assign({},u),{location:new n.default(s,c)})}init(){i.appQuery.elapsedTime$.subscribe(this.update)}handleStopUpdate(t){o.boidsStore.update(t.id,{state:Object.assign(Object.assign({},t.state),{velocity:u.velocity})})}handleContinueUpdate(t){const e=this.getComputedSteering(t),i=(0,r.normalize)(t.state.velocity),s=(0,r.multiply)(i,-1),a=[e,(0,r.multiply)(s,t.traits.frictionFactor)],c=(0,r.applyForces)(t.state.acceleration,a),l=(0,r.limitMagnitude)((0,r.add)(t.state.velocity,c),t.traits.maxSpeed),n=(0,r.add)(t.state.location,l);o.boidsStore.update(t.id,{state:Object.assign(Object.assign({},t.state),{acceleration:u.acceleration,velocity:l,location:n})})}getComputedSteering(t){let e=new n.default(0,0);if(!this.behaviours||!this.behaviours.length)return e;const i=o.boidsQuery.getOtherBoids(t.id);if(this.behaviours.includes(h.Seek)){const i={target:a.uiQuery.pointerVector,source:t},s=(0,l.seek)(i);e=(0,r.add)(e,s)}if(this.behaviours.includes(h.Align)){const s={boids:i,source:t},a=(0,l.align)(s);e=(0,r.add)(e,a)}if(this.behaviours.includes(h.Separate)){const s={boids:i,source:t},a=(0,l.separate)(s);e=(0,r.add)(e,a)}return e}draw(){const t=o.boidsQuery.getBoid(this.id);if(!(null==t?void 0:t.state))return;const e=(0,c.isEntityOffscreen)({v:t.state.location,radius:t.traits.size});s.guiQuery.allValues.showAwarenessArea&&this.drawAwarenessArea(t.state),s.guiQuery.allValues.showSeparationArea&&this.drawSeparationArea(t.state),s.guiQuery.allValues.showStoppingArea&&this.drawStoppingArea(t.state),e||(this.drawShape(t.state),s.guiQuery.allValues.showTargetVector&&this.drawTargetVector(t.state),s.guiQuery.allValues.showNormalizedTargetVector&&this.drawDirectionVector(t.state),s.guiQuery.allValues.showVelocityVector&&this.drawVelocityVector(t.state))}drawAwarenessArea(t){this.ctx.beginPath(),this.ctx.arc(t.location.x,t.location.y,this.traits.awarenessAreaSize,0,2*Math.PI),this.ctx.lineWidth=1,this.ctx.strokeStyle=this.traits.color,this.ctx.stroke()}drawSeparationArea(t){this.ctx.save(),this.ctx.globalAlpha=.35,this.ctx.beginPath(),this.ctx.moveTo(t.location.x-this.traits.size/2,t.location.y-this.traits.size/2),this.ctx.arc(t.location.x,t.location.y,this.traits.separationAreaSize,0,2*Math.PI),this.ctx.fillStyle=this.traits.color,this.ctx.fill(),this.ctx.restore()}drawStoppingArea(t){this.ctx.save(),this.ctx.globalAlpha=.05,this.ctx.beginPath(),this.ctx.moveTo(t.location.x-this.traits.size/2,t.location.y-this.traits.size/2),this.ctx.arc(t.location.x,t.location.y,this.traits.brakingDistance,0,2*Math.PI),this.ctx.fillStyle=e.config.brakingArea.color,this.ctx.fill(),this.ctx.restore()}drawShape(t){this.ctx.beginPath(),this.ctx.moveTo(t.location.x-this.traits.size/2,t.location.y-this.traits.size/2),this.ctx.arc(t.location.x,t.location.y,this.traits.size,0,2*Math.PI),this.ctx.fillStyle=this.traits.color,this.ctx.fill()}drawTargetVector(t){this.ctx.beginPath(),this.ctx.moveTo(t.location.x,t.location.y),this.ctx.lineWidth=1,this.ctx.lineTo(a.uiQuery.pointerVector.x,a.uiQuery.pointerVector.y),this.ctx.strokeStyle=e.config.targetVector.color,this.ctx.stroke()}drawDirectionVector(t){const i=(0,r.multiply)(t.normTargetVector,this.traits.size);this.ctx.beginPath(),this.ctx.moveTo(t.location.x,t.location.y),this.ctx.lineWidth=3,this.ctx.lineTo(t.location.x+i.x,t.location.y+i.y),this.ctx.strokeStyle=e.config.directionVector.color,this.ctx.stroke()}drawVelocityVector(t){const i=(0,r.multiply)(t.velocity,5);this.ctx.beginPath(),this.ctx.moveTo(t.location.x,t.location.y),this.ctx.lineWidth=3,this.ctx.lineTo(t.location.x+i.x,t.location.y+i.y),this.ctx.strokeStyle=e.config.velocityVector.color,this.ctx.stroke()}}exports.default=d;
},{"./config":"LS1Y","../../stores/app":"Whxz","../../stores/gui":"yh4b","../../stores/ui":"Bdnu","../../stores/boids":"iX1u","../../utils/vectorHelper":"ILUX","../../utils/entityHelper":"Mizr","../../behaviours/index":"Kfov","../../geometry/Vector":"Mg1U"}],"ido1":[function(require,module,exports) {
"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.generateRandomizedBoids=void 0;const r=require("./mathHelper"),i=e(require("../actors/Boid/Boid")),t=({total:e,ctx:t,maxX:o,maxY:a,minSize:n,maxSize:l,maxSpeedMultiplier:u,frictionMultiplier:m,brakingMultiplier:s,awarenessMultiplier:d,separationMultiplier:p,colors:c})=>{if(e<1)throw new Error("Total number should be a minimum of 1.");if(n<0||l<n)throw new Error("The min or max size params are incorrect.");return[...new Array(e)].map((e,x)=>{const M={id:x,ctx:t,x:(0,r.getRandomNumber)(0,o),y:(0,r.getRandomNumber)(0,a),size:(0,r.getRandomNumber)(n,l),maxSpeedMultiplier:u,frictionMultiplier:m,brakingMultiplier:s,awarenessMultiplier:d,separationMultiplier:p,color:c[(0,r.getRandomNumber)(0,c.length-1)]};return new i.default(M)})};exports.generateRandomizedBoids=t;
},{"./mathHelper":"wDIF","../actors/Boid/Boid":"NGTN"}],"jagA":[function(require,module,exports) {
"use strict";var e=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),t=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(r){if(r&&r.__esModule)return r;var a={};if(null!=r)for(var o in r)"default"!==o&&Object.prototype.hasOwnProperty.call(r,o)&&e(a,r,o);return t(a,r),a};Object.defineProperty(exports,"__esModule",{value:!0});const a=r(require("dat.gui")),o=require("../stores/gui"),i=Object.assign({},o.guiQuery.allValues);class n{init(){this.setupGUI()}setupGUI(){const e=new a.GUI,t=e.addFolder("fps"),r=e.addFolder("vector"),n=t.add(i,"maxFps"),u=t.add(i,"showFps"),d=r.add(i,"showTargetVector"),s=r.add(i,"showNormalizedTargetVector"),c=r.add(i,"showVelocityVector"),p=r.add(i,"showAwarenessArea"),g=r.add(i,"showSeparationArea"),h=r.add(i,"showStoppingArea");t.open(),r.open(),n.onChange(e=>{o.guiService.updateMaxFps(e)}),u.onChange(e=>{o.guiService.updateShowFps(e)}),d.onChange(e=>{o.guiService.updateShowTargetVector(e)}),s.onChange(e=>{o.guiService.updateShowNormalizedTargetVector(e)}),c.onChange(e=>{o.guiService.updateShowVelocityVector(e)}),p.onChange(e=>{o.guiService.updateShowAwarenessArea(e)}),g.onChange(e=>{o.guiService.updateShowSeparationArea(e)}),h.onChange(e=>{o.guiService.updateShowStoppingArea(e)})}}exports.default=n;
},{"../stores/gui":"yh4b"}],"lfE8":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=require("../stores/app"),e=require("../stores/gui"),s={count:0,lastRenderTime:0};class i{constructor(){this.handleShowFps=(e=>{e?(this.lastDrawTimeSub=t.appQuery.lastDrawTime$.subscribe(this.tick),this.renderInterval=setInterval(this.render,1e3)):(this.lastDrawTimeSub&&this.lastDrawTimeSub.unsubscribe(),this.renderInterval&&clearInterval(this.renderInterval))}),this.tick=(()=>{this.state=Object.assign(Object.assign({},this.state),{count:this.state.count+1})}),this.render=(()=>{if(!this.state.count)return;const t=performance.now(),e=t-this.state.lastRenderTime,s=(this.state.count/e*1e3).toFixed(2);this.state=Object.assign(Object.assign({},this.state),{count:0,lastRenderTime:t}),console.info(`FPS: ${s}`)}),this.state=Object.assign({},s),this.lastDrawTimeSub=null,this.renderInterval=null}init(){e.guiQuery.showFps$.subscribe(this.handleShowFps)}}exports.default=i;
},{"../stores/app":"Whxz","../stores/gui":"yh4b"}],"abQy":[function(require,module,exports) {
"use strict";var t=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});const i=t(require("./actors/Canvas/Canvas")),e=require("./stores/app"),s=require("./stores/gui"),a=require("./stores/boids"),r=t(require("./managers/VisibilityManager")),n=t(require("./managers/PointerManager")),o=require("./config"),c=require("./utils/boidHelper"),d=t(require("./interface/GUI")),u=t(require("./interface/FpsMonitor"));class h{constructor(){this.tick=(t=>{if(!e.appQuery.isRunning)return;requestAnimationFrame(this.tick);const i=t-e.appQuery.lastDrawTime,a=1e3/s.guiQuery.maxFps;if(e.appStore.update({elapsedTime:i}),i>a){const s=t-i%a;e.appStore.update({lastDrawTime:s}),this.draw()}});const t=window.innerWidth,a=window.innerHeight;this.canvasEl=document.getElementById("canvas"),this.ctx=this.canvasEl.getContext("2d",{alpha:!1}),this.canvas=new i.default(this.canvasEl,this.ctx),this.gui=new d.default,this.fpsMonitor=new u.default,this.boids=(0,c.generateRandomizedBoids)(Object.assign(Object.assign({},o.config.boids),{ctx:this.ctx,maxX:t,maxY:a}))}init(){if(!this.ctx)throw new Error("Canvas context could not be initialised.");const t=this.boids.map(t=>({id:t.id,traits:t.traits,state:t.state}));a.boidsStore.set(t),r.default.init(),n.default.init(),this.canvas.init(),this.gui.init(),this.fpsMonitor.init(),this.boids.forEach(t=>t.init()),this.startAnimation()}startAnimation(){const t=performance.now();e.appService.updateLastDrawTime(t),requestAnimationFrame(this.tick)}draw(){this.canvas&&this.canvas.state.isEnabled&&this.canvas.draw(),this.boids&&this.boids.length&&this.boids.forEach(t=>t.draw())}}exports.default=h;
},{"./actors/Canvas/Canvas":"wD9p","./stores/app":"Whxz","./stores/gui":"yh4b","./stores/boids":"iX1u","./managers/VisibilityManager":"tFZS","./managers/PointerManager":"KiIX","./config":"rrcm","./utils/boidHelper":"ido1","./interface/GUI":"jagA","./interface/FpsMonitor":"lfE8"}],"QCba":[function(require,module,exports) {
"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const t=e(require("./scripts/App")),n=new t.default,r=()=>new Promise(e=>{"complete"===document.readyState?e(!0):document.addEventListener("DOMContentLoaded",e)});r().then(()=>n.init());
},{"./scripts/App":"abQy"}]},{},["QCba"], null)